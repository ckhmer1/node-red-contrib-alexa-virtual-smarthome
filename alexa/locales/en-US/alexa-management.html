<script type="text/html" data-help-name="alexa-management">
    <p>Allows to manage the Alexa Smart Home service.</p>

    <h3>Inputs</h3>
        <dl class="message-properties">
            <dt>topic
                <span class="property-type">string</span>
            </dt>
            <dd>Command to run. Can be restartServer, reportState, getState or setState.</dd>
        </dl>

     <h3>Output</h3>
        <dl class="message-properties">
            <dt>payload
                <span class="property-type">object</span>
            </dt>
            <dd>The state of all Alexa Devices (with setState or getState topic).</dd>
        </dl>

    <h3>Details</h3>
        <h4>Node Properties - Alexa SmartHome Settings</h4>
        <p><code>SmartHome</code> Configuration node.</p>
        <h4>Node Properties - Node-RED Settings</h4>
        <p><code>Name</code> Name used by Alexa Smart Home.</p>

        <h4>Input Messages</h4>
        <p>If <code>msg.topic</code> is <code>restartServer</code> the built-in webserver will be restarted. Can be used when your SSL certificate has been renewed and needs to be re-read by the webserver.</p>
        <dl class="message-properties">
            <dt>topic
                <span class="property-type">string</span>
            </dt>
            <dd>A topic of <code>restartServer</code> restarts the built-in webserver. <code>msg.payload</code> is not used for anything.</dd>
        </dl>

        <p>If <code>msg.topic</code> is <code>reportState</code> an update of all device states will be sent to Alexa. Mostly useful for debugging.</p>
        <dl class="message-properties">
            <dt>topic
                <span class="property-type">string</span>
            </dt>
            <dd>A topic of <code>reportState</code> will send an update of all states to Alexa. <code>msg.payload</code> is not used for anything.</dd>
        </dl>

        <p>If <code>msg.topic</code> is <code>getState</code> or <code>getstate</code> the node send a message in output with the state of the Alexa devices.</p>
        <dl class="message-properties">
            <dt>topic
                <span class="property-type">string</span>
            </dt>
            <dd>A topic of <code>getState</code> requests to send to the output the state of the Alexa devices.</dd>
            <dl class="message-properties">
                <dt>payload
                    <span class="property-type">boolean|string|array of string|object</span>
                </dt>
                <dd><code>undefined</code> sends to the output the state of all Alexa devices in an object with key the devices id or name according to the node configuration.</dd>
                <dd><code>true</code> sends to the output the state of all Alexa devices with the "Persistent State" enabled in an object with key the devices id or name according to the node configuration.</dd>
                <dd><code>string</code> sends to the output the state of the Alexa device with the id or the name specified in the payload in an object with key the device id or name according to the node configuration.</dd>
                <dd><code>array of strings</code> sends to the output the state of the Alexa devices with the ids or names specified in the payload in an object with key the device id or name according to the node configuration.</dd>
                <dd><code>object</code> the object attributes can be <code>onlyPersistent</code>, <code>useNames</code> or <code>devices</code>, sends to the output the state of the Alexa devices in according to the payload and to the node configuration.</dd>
            </dl>    
        </dl>

        <p>If <code>msg.topic</code> is <code>setState</code> or <code>setstate</code> the node updates the Alexa devices states with the states contained on the <code>msg.payload</code>.</p>
        <dl class="message-properties">
            <dt>topic
                <span class="property-type">object</span>
            </dt>
            <dd>A topic of <code>setState</code> updates the Alexa devices states with the value of the <code>msg.payload</code>.</dd>
        </dl>

        <h4>Output Messages</h4>
        <p>This node will output debug messages if something goes wrong or the state of all Alexa Devices (with setState or getState topic).</p>
        <dl class="message-properties">
            <dt>payload
                <span class="property-type">string|object</span>
            </dt>
            <dd>This node will output debug messages if something goes wrong or the state of all Alexa Devices (with setState or getState topic).</dd>
        </dl>

        <p>If a device state changes, the node output a message with the <code>msg.topic</code> set to <code>setState</code>, and the <code>msg.payload</code> contains all the Alexa devices states that can be persisted if needed. This message can be passed into the node to restore the persisted state.</p>

    <h3>References</h3>
        <ul>
            <li><a href="https://github.com/ckhmer1/node-red-contrib-alexa-virtual-smarthome#the-config-node">GitHub</a> - the nodes github repository</li>
        </ul>

</script>
